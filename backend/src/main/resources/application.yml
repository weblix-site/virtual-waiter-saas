server:
  port: 8080
spring:
  messages:
    basename: i18n/messages
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/vw}
    username: ${SPRING_DATASOURCE_USERNAME:vw}
    password: ${SPRING_DATASOURCE_PASSWORD:vw}
  jpa:
    hibernate:
      ddl-auto: validate
  flyway:
    enabled: true

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus,loggers
  endpoint:
    health:
      probes:
        enabled: true
      show-details: never
    prometheus:
      enabled: true
  metrics:
    export:
      prometheus:
        enabled: true

app:
  bill:
    expireMinutes: 120
    allowPayOtherGuestsItems: false
    allowPayWholeTable: false
  qr:
    hmacSecret: ${APP_QR_HMAC_SECRET:}
    signatureTtlSeconds: 86400
    allowedClockSkewSeconds: 120
    allowLegacySig: false
  publicBaseUrl: ${APP_PUBLIC_BASE_URL:http://localhost:3000}
  auth:
    cookieSecret: ${APP_AUTH_COOKIE_SECRET:}
    cookieName: ${APP_AUTH_COOKIE_NAME:vw_auth}
    cookieMaxAgeSeconds: ${APP_AUTH_COOKIE_MAX_AGE_SECONDS:604800}
    cookieSecure: ${APP_AUTH_COOKIE_SECURE:true}
  otp:
    requireForFirstOrder: false
    ttlSeconds: 180
    maxAttempts: 5
    resendCooldownSeconds: 60
    length: 4
    devEchoCode: true
  rateLimit:
    redis:
      enabled: ${APP_RATELIMIT_REDIS_ENABLED:false}
      host: ${APP_RATELIMIT_REDIS_HOST:}
      port: ${APP_RATELIMIT_REDIS_PORT:6379}
      password: ${APP_RATELIMIT_REDIS_PASSWORD:}
    otp:
      maxRequests: 5
      windowSeconds: 300
    otpVerify:
      maxRequests: 8
      windowSeconds: 300
    order:
      maxRequests: 10
      windowSeconds: 60
    party:
      maxRequests: 10
      windowSeconds: 60
    waiterCall:
      maxRequests: 10
      windowSeconds: 60
    sessionStart:
      maxRequests: 30
      windowSeconds: 60
    menu:
      maxRequests: 60
      windowSeconds: 60
    chat:
      maxRequests: 15
      windowSeconds: 60
  audit:
    maxDetailsChars: ${APP_AUDIT_MAX_DETAILS_CHARS:4000}
  media:
    maxPhotoUrlLength: ${APP_MEDIA_MAX_PHOTO_URL_LENGTH:512}
    maxPhotoUrlsCount: ${APP_MEDIA_MAX_PHOTO_URLS_COUNT:6}
    allowedPhotoExts: ${APP_MEDIA_ALLOWED_PHOTO_EXTS:jpg,jpeg,png,webp,gif}

  tips:
    enabled: false
    percentages: [5,10,15,20]

push:
  provider: LOG
  fcmServerKey: ${FCM_SERVER_KEY:}
  fcmApiUrl: "https://fcm.googleapis.com/fcm/send"
  dryRun: false
  maxPayloadBytes: ${PUSH_MAX_PAYLOAD_BYTES:4096}
